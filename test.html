<!DOCTYPE html>
<html>
<title>Test</title>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<body>

<canvas id="myCanvas" width="400px" height="400px" style="border:1px solid #000000;"></canvas>

<script>

var myTurn = "true";
var turn = 0;
var moveX = [];
var moveY = [];
var eligible = "true";
var used = "false";
var i = 1;

var canvas = document.getElementById("myCanvas");
var context = canvas.getContext("2d");
context.font = "30px Arial";

canvas.style.marginLeft = window.innerWidth/2 - canvas.width/2 + "px"
canvas.style.marginTop = window.innerHeight/2 - canvas.height/2 + "px"

var x1 = 0;
var x2 = canvas.width/3;
var x3 = canvas.width/3 * 2;
var y1 = 0;
var y2 = canvas.height/3;
var y3 = canvas.height/3 * 2;
var size = canvas.width/3;

context.strokeStyle = "black";
context.rect(x1, y1, size, size);
context.stroke();
context.strokeStyle = "black";	
context.rect(x2, y1, size, size);
context.stroke();
context.strokeStyle = "black";
context.rect(x3, y1, size, size);
context.stroke();

context.strokeStyle = "black";
context.rect(x1, y2, size, size);
context.stroke();
context.strokeStyle = "black";	
context.rect(x2, y2, size, size);
context.stroke();
context.strokeStyle = "black";
context.rect(x3, y2, size, size);
context.stroke();

context.strokeStyle = "black";
context.rect(x1, y3, size, size);
context.stroke();
context.strokeStyle = "black";	
context.rect(x2, y3, size, size);
context.stroke();
context.strokeStyle = "black";
context.rect(x3, y3, size, size);
context.stroke();

canvas.addEventListener("click", (evt) => {

if (myTurn == "true") {

eligible = "true";
i = 1;

var clickX = evt.clientX - canvas.offsetLeft;
var clickY = evt.clientY - canvas.offsetTop;

if (clickX > x1 && clickX < x2) {
var xFill = x1;
}
if (clickX > x2 && clickX < x3) {
var xFill = x2;
}
if (clickX > x3 && clickX < canvas.width) {
var xFill = x3;
}

if (clickY > x1 && clickY < y2) {
var yFill = y1;
}
if (clickY > x2 && clickY < y3) {
var yFill = y2;
}
if (clickY > x3 && clickY < canvas.width) {
var yFill = y3;
}

moveX.forEach(checkEligible);

function checkEligible() {

/*
alert(moveX)
alert(moveY)
alert(moveX[i])
alert(moveY[i])
alert(xFill)
alert(yFill)
*/

if (moveX[i] == xFill && moveY[i] == yFill) {
eligible = "false";
}

i ++ 

}

i = 1;
used = "false";

if (eligible == "true") {

context.fillStyle = "black";
context.fillRect(xFill, yFill, size, size);
myTurn = "false";
turn ++;
moveX[turn] = xFill;
moveY[turn] = yFill; 

moveX.forEach(checkRow);

if (!(moveX[1] == x2 && moveY[1] == y2)) {
if (turn == 1) {
context.fillStyle = "red";
context.fillRect(x2, y2, size, size);
myTurn = "true";
turn ++;
moveX[turn] = x2; 
moveY[turn] = y2; 
}
} else {
context.fillStyle = "red";
context.fillRect(x1, y1, size, size);
myTurn = "true";
turn ++;
moveX[turn] = x1; 
moveY[turn] = y1; 
}

}

function checkRow() {

if (moveY[turn] == moveY[i]) {

if (moveX[turn] == moveX[i] + canvas.width/3 || moveX[turn] == moveX[i] - canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (moveX[i] == x1 || moveX[i] == x2 && moveX[turn] == x2 || moveX[turn] == x1) {

if (!(moveX.some(checkX1 => checkX1 == x3) && moveY.some(checkY1 => checkY1 == moveY[turn]))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(x3, moveY[turn], size, size);
myTurn = "true";
turn ++;
moveX[turn] = x3;
used = "true";
}
}
}
}
}

if (moveX[turn] == moveX[i] + canvas.width/3 || moveX[turn] == moveX[i] - canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (moveX[i] == x2 || moveX[i] == x3 && moveX[turn] == x3 || moveX[turn] == x2) {

if (!(moveX.some(checkX2 => checkX2 == x1) && moveY.some(checkY2 => checkY2 == moveY[turn]))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(x1, moveY[turn], size, size);
myTurn = "true";
turn ++;
moveX[turn] = x1;
moveY[turn] = moveY[turn];
used = "true";
}
}
}
}
}

if (moveX[turn] == moveX[i] + canvas.width/3 * 2 || moveX[turn] == moveX[i] - canvas.width/3 * 2) {

alert("1");

if (!(Math.round(i/2) == i/2)) {

alert("2");

alert("3");

if (used == "false") {

alert("4");

context.fillStyle = "red";
context.fillRect(x2, moveY[turn], size, size);
myTurn = "true";
turn ++;
moveX[turn] = x2;
moveY[turn] = moveY[turn];
used = "true";
}
}
}
}

if (moveX[turn] == moveX[i]) {

if (moveY[turn] == moveY[i] + canvas.width/3 || moveY[turn] == moveY[i] - canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (moveY[i] == y1 || moveY[i] == y2 && moveY[turn] == y2 || moveY[turn] == y1) {

if (!(moveX.some(checkX4 => checkX4 == moveX[turn]) && moveY.some(checkY4 => checkY4 == y3))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(moveX[turn], y3, size, size);
myTurn = "true";
turn ++;
moveX[turn] = moveX[turn];
moveY[turn] = y3;
used = "true";
}
}
}
}
}

if (moveY[turn] == moveY[i] + canvas.width/3 || moveY[turn] == moveY[i] - canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (moveY[i] == y2 || moveY[i] == y3 && moveY[turn] == y3 || moveY[turn] == y2) {

if (!(moveX.some(checkX5 => checkX5 == moveX[turn]) && moveY.some(checkY5 => checkY5 == y1))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(moveX[turn], y1, size, size);
myTurn = "true";
turn ++;
moveX[turn] = moveX[turn];
moveY[turn] = y1;
used = "true";
}
}
}
}
}

if (moveY[turn] == moveY[i] + canvas.width/3 * 2 || moveY[turn] == moveY[i] - canvas.width/3 * 2) {
if (!(Math.round(i/2) == i/2)) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(moveX[turn], y2, size, size);
myTurn = "true";
turn ++;
moveX[turn] = moveX[turn];
moveY[turn] = y2;
used = "true";
}
}
}
}

if (moveY[turn] == moveY[i] + canvas.width/3 && moveY[turn] == moveY[i] + canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (!(moveX.some(checkX7 => checkX7 == x3) && moveY.some(checkY7 => checkY7 == y1))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(x3, y1, size, size);
myTurn = "true";
turn ++;
moveX[turn] = x3;
moveY[turn] = y1;
used = "true";
}
}
}
}

if (moveY[turn] == moveY[i] - canvas.width/3 && moveY[turn] == moveY[i] - canvas.width/3) {
if (!(Math.round(i/2) == i/2)) {

if (!(moveX.some(checkX8 => checkX8 == x1) && moveY.some(checkY8 => checkY8 == y3))) {

if (used == "false") {

context.fillStyle = "red";
context.fillRect(x1, y3, size, size);
myTurn = "true";
turn ++;
moveX[turn] = x1;
moveY[turn] = y3;
used = "true";
}
}
}
}

i ++ 

}
if (used == "false") {



}
}
});
</script>	

</body>
</html>